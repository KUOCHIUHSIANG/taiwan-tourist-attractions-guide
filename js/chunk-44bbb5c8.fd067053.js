(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44bbb5c8"],{"1a49":function(t,i,e){"use strict";e("8fba")},"8fba":function(t,i,e){},abae:function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t._self._c;return i("div",{staticClass:"activity-container"},[i("SharedPage",{attrs:{"initial-inside-page-data":t.activity,center:{lat:t.lat,lng:t.lng}}}),0!==t.nearbyActivities.length?i("SharedCardsList",{attrs:{"initial-card-list":t.nearbyActivities,"initial-title":t.nearByTitle,"initial-sub-title":t.nearBySubTitle}}):t._e()],1)},a=[],c=(e("14d9"),e("d9e2"),e("c8fe")),n=e("0204"),r=e("28d9"),o=e("ac0d"),h=e("4360"),y=e("2f62"),d={mixins:[o["b"]],components:{SharedPage:c["a"],SharedCardsList:n["a"]},created(){this.fetchActivity(this.$route.params.ActivityID)},mounted(){window.addEventListener("resize",this.getDimensions)},unmounted(){window.removeEventListener("resize",this.getDimensions)},data(){return{activity:{},nearbyActivities:[],lat:0,lng:0}},methods:{async fetchActivity(t){try{const i=await r["a"].getActivity({id:t});if(0===i.data.length)return this.$toast.error("此活動不存在",{timeout:1500}),void this.$router.push({name:"search-activity"});const[e]=i.data;if(this.activity={id:e.ActivityID,name:e.ActivityName,description:e.Description,phone:e.Phone,address:e.Address?e.Address:"未提供",startTime:e.StartTime,endTime:e.EndTime,city:e.City?e.City:"未提供",class1:e.Class1,class2:e.Class2,websiteUrl:e.WebsiteUrl,picture:e.Picture,position:e.Position,charge:e.Charge,remarks:e.Remarks,organizer:e.Organizer},this.lat=this.activity.position.PositionLat,this.lng=this.activity.position.PositionLon,"未提供"!==this.activity.city){let t=this.cities.map(t=>t.name),i=t.indexOf(this.activity.city),e=this.cities[i].engName;this.fetchRecentActivitiesByCity(e)}else this.nearbyActivities=[]}catch(i){401===i.response.status?(h["a"].dispatch("getToken"),this.fetchActivity(this.$route.params.ActivityID)):console.log(i)}},async fetchRecentActivitiesByCity(t){try{const i=new Date,e=i.getFullYear();let s=i.getMonth()+1,a=i.getDate();const c=4,n=await r["a"].getRecentActivitiesByCity({year:e,month:s,day:a,city:t,amount:c});if("OK"!==n.statusText)throw new Error(n);this.nearbyActivities=n.data.map(t=>({id:t.ActivityID,name:t.ActivityName,city:t.City?t.City:"未提供",picture:t.Picture})),this.nearbyActivities=this.nearbyActivities.filter(t=>t.id!==this.activity.id)}catch(i){401===i.response.status?(h["a"].dispatch("getToken"),this.fetchActivity(this.$route.params.ActivityID)):console.log(i)}}},computed:{...Object(y["b"])(["cities"])},watch:{activity(){this.getDimensions()}},beforeRouteUpdate(t,i,e){const{ActivityID:s}=t.params;this.fetchActivity(s),e()}},l=d,v=(e("1a49"),e("2877")),u=Object(v["a"])(l,s,a,!1,null,"68a233dd",null);i["default"]=u.exports}}]);
//# sourceMappingURL=chunk-44bbb5c8.fd067053.js.map